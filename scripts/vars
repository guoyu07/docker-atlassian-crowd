#!sh

# System specific
export TIMEZONE="${TIMEZONE:-UTC}"

# Atlassian Crowd
export CROWD_HOME="${CROWD_HOME:-/crowd}"
export CROWD_SERVER_ID="${CROWD_SERVER_ID}"

# Automatic Setup
export CROWD_SETUP="${CROWD_SETUP:-true}"

export CROWD_SETUP_DATABASE_TYPE="${CROWD_SETUP_DATABASE_TYPE:-embedded}"
export CROWD_SETUP_DATABASE_ENGINE="${CROWD_SETUP_DATABASE_ENGINE:-postgresql}"
export CROWD_SETUP_DATABASE_SERVER="${CROWD_SETUP_DATABASE_SERVER:-postgres}"
export CROWD_SETUP_DATABASE_PORT="${CROWD_SETUP_DATABASE_PORT:-5432}"
export CROWD_SETUP_DATABASE_NAME="${CROWD_SETUP_DATABASE_NAME:-crowd}"
export CROWD_SETUP_DATABASE_USERNAME="${CROWD_SETUP_DATABASE_USERNAME:-crowd}"
export CROWD_SETUP_DATABASE_PASSWORD="${CROWD_SETUP_DATABASE_PASSWORD:-supersecret}"
export CROWD_SETUP_DATABASE_OVERWRITE="${CROWD_SETUP_DATABASE_OVERWRITE:-false}"

export CROWD_SETUP_SERVER_TITLE="${CROWD_SETUP_SERVER_TITLE:-Crowd}"
export CROWD_SETUP_BASEURL="${CROWD_SETUP_BASEURL:-http://localhost:8095/crowd}"
export CROWD_SETUP_SESSION_TIME="${CROWD_SETUP_SESSION_TIME:-30}"

export CROWD_SETUP_MAILSERVER="${CROWD_SETUP_MAILSERVER:-false}"
export CROWD_SETUP_MAILSERVER_RECEIVER="${CROWD_SETUP_MAILSERVER_RECEIVER:-administrator@example.com}"
export CROWD_SETUP_MAILSERVER_SENDER="${CROWD_SETUP_MAILSERVER_SENDER:-crowd@example.com}"
export CROWD_SETUP_MAILSERVER_SUBJECT_PREFIX="${CROWD_SETUP_MAILSERVER_SUBJECT_PREFIX:-[Crowd - Atlassian Crowd]}"
export CROWD_SETUP_MAILSERVER_JNDI="${CROWD_SETUP_MAILSERVER_JNDI}"
export CROWD_SETUP_MAILSERVER_HOST="${CROWD_SETUP_MAILSERVER_HOST:-mail.example.com}"
export CROWD_SETUP_MAILSERVER_PORT="${CROWD_SETUP_MAILSERVER_PORT:-465}"
export CROWD_SETUP_MAILSERVER_USERNAME="${CROWD_SETUP_MAILSERVER_USERNAME:-crowd}"
export CROWD_SETUP_MAILSERVER_PASSWORD="${CROWD_SETUP_MAILSERVER_PASSWORD:-supersecret}"
export CROWD_SETUP_MAILSERVER_SSL="${CROWD_SETUP_MAILSERVER_SSL:-true}"
export CROWD_SETUP_MAILSERVER_JNDI_LOCATION="${CROWD_SETUP_MAILSERVER_JNDI_LOCATION}"

export CROWD_SETUP_DIRECTORY_NAME="${CROWD_SETUP_DIRECTORY_NAME:-Crowd server directory}"
export CROWD_SETUP_DIRECTORY_DESCRIPTION="${CROWD_SETUP_DIRECTORY_DESCRIPTION}"
export CROWD_SETUP_DIRECTORY_PASSWORD_REGEX="${CROWD_SETUP_DIRECTORY_PASSWORD_REGEX}"
export CROWD_SETUP_DIRECTORY_PASSWORD_COMPLEXITY_MESSAGE="${CROWD_SETUP_DIRECTORY_PASSWORD_COMPLEXITY_MESSAGE}"
export CROWD_SETUP_DIRECTORY_PASSWORD_MAX_ATTEMPTS="${CROWD_SETUP_DIRECTORY_PASSWORD_MAX_ATTEMPTS:-0}"
export CROWD_SETUP_DIRECTORY_PASSWORD_MAX_CHANGE_TIME="${CROWD_SETUP_DIRECTORY_PASSWORD_MAX_CHANGE_TIME:-0}"
export CROWD_SETUP_DIRECTORY_PASSWORD_HISTORY_COUNT="${CROWD_SETUP_DIRECTORY_PASSWORD_HISTORY_COUNT:-0}"
export CROWD_SETUP_DIRECTORY_USER_ENCRYPTION_METHOD="${CROWD_SETUP_DIRECTORY_USER_ENCRYPTION_METHOD:-atlassian-security}"

export CROWD_SETUP_ADMINISTRATOR_EMAIL="${CROWD_SETUP_ADMINISTRATOR_EMAIL:-admin@example.com}"
export CROWD_SETUP_ADMINISTRATOR_USERNAME="${CROWD_SETUP_ADMINISTRATOR_USERNAME:-administrator}"
export CROWD_SETUP_ADMINISTRATOR_PASSWORD="${CROWD_SETUP_ADMINISTRATOR_PASSWORD:-supersecret}"
export CROWD_SETUP_ADMINISTRATOR_FIRSTNAME="${CROWD_SETUP_ADMINISTRATOR_FIRSTNAME:-Crowd}"
export CROWD_SETUP_ADMINISTRATOR_LASTNAME="${CROWD_SETUP_ADMINISTRATOR_LASTNAME:-Administrator}"

export CROWD_SETUP_INTEGRATION_OPENID_SERVER="${CROWD_SETUP_INTEGRATION_OPENID_SERVER:-true}"
export CROWD_SETUP_INTEGRATION_DEMO_APPLICATION="${CROWD_SETUP_INTEGRATION_DEMO_APPLICATION:-false}"

# Tomcat
export CATALINA_HOME="${CATALINA_HOME:-/app/apache-tomcat}"
export CATALINA_TMPDIR="${CATALINA_TMPDIR:-/tmp}"

# Single-Sign-On (Crowd SSO)

## Path to properties-files
export CROWD_SSO_PROPERTIES_CROWD="${CROWD_SSO_PROPERTIES_CROWD:-$CROWD_HOME/crowd.properties}"
export CROWD_SSO_PROPERTIES_OPENIDSERVER="${CROWD_SSO_PROPERTIES_OPENIDSERVER:-$CATALINA_HOME/../crowd-openidserver-webapp/WEB-INF/classes/crowd.properties}"
export CROWD_SSO_PROPERTIES_CLIENT="${CROWD_SSO_PROPERTIES_OPENIDCLIENT:-$CATALINA_HOME/../client/WEB-INF/classes/crowd.properties}"
export CROWD_SSO_PROPERTIES_DEMOWEBAPP="${CROWD_SSO_PROPERTIES_DEMOWEBAPP:-$CATALINA_HOME/../demo-webapp/WEB-INF/classes/crowd.properties}"

# crowd sso
export CROWD_SSO_APP_CROWD_SESSION_LASTVALIDATION="${CROWD_SSO_APP_CROWD_SESSION_LASTVALIDATION:-session.lastvalidation}"
export CROWD_SSO_APP_CROWD_SESSION_TOKENKEY="${CROWD_SSO_APP_CROWD_SESSION_LASTVALIDATION:-session.tokenkey}"
export CROWD_SSO_APP_CROWD_CROWD_SERVER_URL="${CROWD_SSO_APP_CROWD_CROWD_SERVER_URL:-http://localhost:8095/crowd/services/}"
export CROWD_SSO_APP_CROWD_APPLICATION_NAME="${CROWD_SSO_APP_CROWD_APPLICATION_NAME:-crowd}"
export CROWD_SSO_APP_CROWD_HTTP_TIMEOUT="${CROWD_SSO_APP_CROWD_HTTP_TIMEOUT:-30000}"
export CROWD_SSO_APP_CROWD_SESSION_ISAUTHENTICATED="${CROWD_SSO_APP_CROWD_SESSION_ISAUTHENTICATED:-session.isauthenticated}"
export CROWD_SSO_APP_CROWD_APPLICATION_LOGIN_URL="${CROWD_SSO_APP_CROWD_APPLICATION_LOGIN_URL:-http://localhost:8095/crowd}"
export CROWD_SSO_APP_CROWD_APPLICATION_BASE_URL="${CROWD_SSO_APP_CROWD_APPLICATION_BASE_URL:-http://localhost:8095/crowd}"
export CROWD_SSO_APP_CROWD_SESSION_VALIDATIONINTERVAL="${CROWD_SSO_APP_CROWD_SESSION_VALIDATIONINTERVAL:-0}"
export CROWD_SSO_APP_CROWD_APPLICATION_PASSWORD="${CROWD_SSO_APP_CROWD_APPLICATION_PASSWORD:-password}"

# openid-server sso
export CROWD_SSO_APP_OPENIDSERVER_SESSION_LASTVALIDATION="${CROWD_SSO_APP_OPENIDSERVER_SESSION_LASTVALIDATION:-session.lastvalidation}"
export CROWD_SSO_APP_OPENIDSERVER_SESSION_TOKENKEY="${CROWD_SSO_APP_OPENIDSERVER_SESSION_LASTVALIDATION:-session.tokenkey}"
export CROWD_SSO_APP_OPENIDSERVER_CROWD_SERVER_URL="${CROWD_SSO_APP_OPENIDSERVER_CROWD_SERVER_URL:-http://localhost:8095/crowd/services/}"
export CROWD_SSO_APP_OPENIDSERVER_APPLICATION_NAME="${CROWD_SSO_APP_OPENIDSERVER_APPLICATION_NAME:-crowd-openid-server}"
export CROWD_SSO_APP_OPENIDSERVER_HTTP_TIMEOUT="${CROWD_SSO_APP_OPENIDSERVER_HTTP_TIMEOUT:-30000}"
export CROWD_SSO_APP_OPENIDSERVER_SESSION_ISAUTHENTICATED="${CROWD_SSO_APP_OPENIDSERVER_SESSION_ISAUTHENTICATED:-session.isauthenticated}"
export CROWD_SSO_APP_OPENIDSERVER_APPLICATION_LOGIN_URL="${CROWD_SSO_APP_OPENIDSERVER_APPLICATION_LOGIN_URL:-http://localhost:8095/openidserver}"
export CROWD_SSO_APP_OPENIDSERVER_APPLICATION_LOGIN_URL_TEMPLATE="${CROWD_SSO_APP_OPENIDSERVER_APPLICATION_LOGIN_URL_TEMPLATE:-http://localhost:8095/openidserver?returnToUrl=\${RETURN_TO_URL}}"
export CROWD_SSO_APP_OPENIDSERVER_APPLICATION_BASE_URL="${CROWD_SSO_APP_OPENIDSERVER_APPLICATION_BASE_URL:-http://localhost:8095/openidserver}"
export CROWD_SSO_APP_OPENIDSERVER_SESSION_VALIDATIONINTERVAL="${CROWD_SSO_APP_OPENIDSERVER_SESSION_VALIDATIONINTERVAL:-0}"
export CROWD_SSO_APP_OPENIDSERVER_APPLICATION_PASSWORD="${CROWD_SSO_APP_OPENIDSERVER_APPLICATION_PASSWORD:-password}"

# openid-client sso
export CROWD_SSO_APP_CLIENT_SESSION_LASTVALIDATION="${CROWD_SSO_APP_CLIENT_SESSION_LASTVALIDATION:-session.lastvalidation}"
export CROWD_SSO_APP_CLIENT_SESSION_TOKENKEY="${CROWD_SSO_APP_CLIENT_SESSION_LASTVALIDATION:-session.tokenkey}"
export CROWD_SSO_APP_CLIENT_CROWD_SERVER_URL="${CROWD_SSO_APP_CLIENT_CROWD_SERVER_URL:-http://localhost:8095/crowd/services/}"
export CROWD_SSO_APP_CLIENT_APPLICATION_NAME="${CROWD_SSO_APP_CLIENT_APPLICATION_NAME:-crowd}"
export CROWD_SSO_APP_CLIENT_HTTP_TIMEOUT="${CROWD_SSO_APP_CLIENT_HTTP_TIMEOUT:-30000}"
export CROWD_SSO_APP_CLIENT_SESSION_ISAUTHENTICATED="${CROWD_SSO_APP_CLIENT_SESSION_ISAUTHENTICATED:-session.isauthenticated}"
export CROWD_SSO_APP_CLIENT_APPLICATION_LOGIN_URL="${CROWD_SSO_APP_CLIENT_APPLICATION_LOGIN_URL:-http://localhost:8095/crowd/console}"
export CROWD_SSO_APP_CLIENT_APPLICATION_BASE_URL="${CROWD_SSO_APP_CLIENT_APPLICATION_BASE_URL:-http://localhost:8095/crowd}"
export CROWD_SSO_APP_CLIENT_SESSION_VALIDATIONINTERVAL="${CROWD_SSO_APP_CLIENT_SESSION_VALIDATIONINTERVAL:-0}"
export CROWD_SSO_APP_CLIENT_APPLICATION_PASSWORD="${CROWD_SSO_APP_CLIENT_APPLICATION_PASSWORD:-password}"

# demo-webapp sso
export CROWD_SSO_APP_DEMOWEBAPP_SESSION_LASTVALIDATION="${CROWD_SSO_APP_DEMOWEBAPP_SESSION_LASTVALIDATION:-session.lastvalidation}"
export CROWD_SSO_APP_DEMOWEBAPP_SESSION_TOKENKEY="${CROWD_SSO_APP_DEMOWEBAPP_SESSION_LASTVALIDATION:-session.tokenkey}"
export CROWD_SSO_APP_DEMOWEBAPP_CROWD_SERVER_URL="${CROWD_SSO_APP_DEMOWEBAPP_CROWD_SERVER_URL:-http://localhost:8095/crowd/services/}"
export CROWD_SSO_APP_DEMOWEBAPP_APPLICATION_NAME="${CROWD_SSO_APP_DEMOWEBAPP_APPLICATION_NAME:-demo}"
export CROWD_SSO_APP_DEMOWEBAPP_HTTP_TIMEOUT="${CROWD_SSO_APP_DEMOWEBAPP_HTTP_TIMEOUT:-30000}"
export CROWD_SSO_APP_DEMOWEBAPP_SESSION_ISAUTHENTICATED="${CROWD_SSO_APP_DEMOWEBAPP_SESSION_ISAUTHENTICATED:-session.isauthenticated}"
export CROWD_SSO_APP_DEMOWEBAPP_APPLICATION_LOGIN_URL="${CROWD_SSO_APP_DEMOWEBAPP_APPLICATION_LOGIN_URL:-http://localhost:8095/demo}"
export CROWD_SSO_APP_DEMOWEBAPP_SESSION_VALIDATIONINTERVAL="${CROWD_SSO_APP_DEMOWEBAPP_SESSION_VALIDATIONINTERVAL:-0}"
export CROWD_SSO_APP_DEMOWEBAPP_APPLICATION_PASSWORD="${CROWD_SSO_APP_DEMOWEBAPP_APPLICATION_PASSWORD:-password}"